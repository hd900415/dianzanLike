/* 橘子科技旗下 A4源码  https://an4.net 搭建二开联系 QQ 3479863005  纸飞机联系 @orangetech */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-201b322c"],{"32f3":function(t,s,a){"use strict";var e=a("7811"),i=a.n(e);i.a},5104:function(t,s,a){"use strict";(function(t){s["a"]={name:"PostTask",components:{},props:["taskId"],data(){return{taskType:[],taskTips:"",levelOptions:[],showCalendar:!1,fileList:[],conditionArr:[],showSteps:!1,stepData:[{img:[],describe:""}],postData:{task_class:0,title:"",content:"",reward_price:1,total_number:"",person_time:1,total_price:0,link_info:"",task_level:1,end_time:"",finish_condition:"",examine_demo:"",task_step:[]}}},computed:{},watch:{},created(){this.$parent.navBarTitle=this.$t("postTask.navBar.title"),this.taskType=this.InitData.taskclasslist.flatMap(t=>[{text:t.group_name,value:t.group_id}]),this.levelOptions=this.InitData.UserGradeList.flatMap(t=>[{text:t.name,value:t.grade}]),this.taskId?this.$Model.GetTaskinfo(this.taskId,t=>{1==t.code&&(this.postData={id:this.taskId,task_class:t.info.task_class,title:t.info.title,content:t.info.content,reward_price:Number(t.info.reward_price),total_number:Number(t.info.total_number),person_time:Number(t.info.person_time),total_price:Number(t.info.total_price)+Number(t.info.total_price)*this.UserInfo.pump,link_info:t.info.link_info,task_level:t.info.task_level,end_time:t.info.end_time,finish_condition:t.info.finish_condition||"",examine_demo:t.info.examine_demo||"",task_step:t.info.task_step||[]},this.taskTips=this.InitData.taskclasslist.find(s=>s.group_id==t.info.task_class).group_info,this.conditionArr=t.info.finish_condition||[],this.fileList=t.info.examine_demo?t.info.examine_demo.flatMap(t=>[{url:this.ApiUrl+t}]):[],this.stepData=t.info.task_step?t.info.task_step.flatMap(t=>[{img:[{url:this.ApiUrl+t.img}],describe:t.describe}]):[])}):(this.taskTips=this.InitData.taskclasslist[0].group_info,this.postData.task_class=this.InitData.taskclasslist[0].group_id,this.postData.task_level=this.InitData.UserGradeList[0].grade)},mounted(){},activated(){},destroyed(){},methods:{changeDropdown(t){this.taskTips=this.InitData.taskclasslist.find(s=>s.group_id==t).group_info},onConfirm(t){this.showCalendar=!1,this.postData.end_time=this.$Util.DateFormat("YY-MM-DD",t)},afterRead(t){t.status="uploading",t.message=this.$t("upload[0]"),this.uploadImgs(t)},uploadImgs(t){if(!t.file.type.match(/image/))return t.status="failed",void(t.message=this.$t("upload[1]"));this.$Util.CompressImg(t.file.type,t.content,750,s=>{let a=new FormData;a.append("token",localStorage["Token"]),a.append("type",3),a.append("image",s,t.file.name),this.$Model.UploadImg(a,s=>{1==s.code?(t.message=this.$t("upload[2]"),t.status="success",t.url=s.url):(t.status="failed",t.message=this.$t("upload[3]"))})})},minusSteps(){1==this.stepData.length&&this.$Dialog.Toast(this.$t("postTask.tips[2]")),this.stepData.length>1&&this.stepData.pop()},pushSteps(){10==this.stepData.length&&this.$Dialog.Toast(this.$t("postTask.tips[3]")),this.stepData.length<10&&this.stepData.push({img:[],describe:""})},totalPrice(){this.postData.total_price=this.postData.reward_price*this.postData.total_number+this.postData.reward_price*this.postData.total_number*this.UserInfo.pump},onSubmit(){const s=this.stepData.findIndex(t=>!t.img.length)+1;s?this.postData.task_step=[]:(this.postData.task_step=[],this.stepData.forEach(t=>{this.postData.task_step.push({img:t.img[0].url.replace(this.ApiUrl,""),describe:t.describe})})),this.postData.title?this.postData.reward_price?this.postData.reward_price<1?this.$Dialog.Toast(this.$t("postTask.field[3].error[1]")):this.postData.total_number?this.postData.person_time?this.postData.total_price?this.postData.link_info?this.postData.end_time?this.postData.task_step.length?(this.conditionArr.length?this.postData.finish_condition=this.conditionArr:this.postData.finish_condition="",this.fileList.length?this.postData.examine_demo=this.fileList.flatMap(t=>t.url.replace(this.ApiUrl,"")):this.postData.examine_demo="",this.$Model.PostTask(this.postData,s=>{1==s.code&&(this.taskId?(this.postData={task_class:this.InitData.taskclasslist[0].group_id,title:"",content:"",reward_price:1,total_number:"",person_time:1,total_price:0,link_info:"",task_level:1,end_time:"",finish_condition:"",examine_demo:"",task_step:[]},this.conditionArr=[],this.fileList=[],this.stepData=[{img:[],describe:""}],t(".ScrollBox")[0].scrollTop=0):this.$router.go(-1))})):this.$Dialog.Toast(this.$t("postTask.field[12].error")):this.$Dialog.Toast(this.$t("postTask.field[9].error")):this.$Dialog.Toast(this.$t("postTask.field[7].error")):this.$Dialog.Toast(this.$t("postTask.field[6].error")):this.$Dialog.Toast(this.$t("postTask.field[5].error")):this.$Dialog.Toast(this.$t("postTask.field[4].error")):this.$Dialog.Toast(this.$t("postTask.field[3].error[0]")):this.$Dialog.Toast(this.$t("postTask.field[1].error"))}}}}).call(this,a("1157"))},6940:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"PageBox",staticStyle:{"padding-bottom":"54px"}},[a("div",{staticClass:"ScrollBox"},[a("van-form",{attrs:{"label-width":"70"}},[a("van-field",{staticClass:"m0",attrs:{label:t.$t("postTask.field[0].label"),border:!1}},[a("van-dropdown-menu",{attrs:{slot:"input"},slot:"input"},[a("van-dropdown-item",{attrs:{options:t.taskType},on:{change:t.changeDropdown},model:{value:t.postData.task_class,callback:function(s){t.$set(t.postData,"task_class",s)},expression:"postData.task_class"}})],1)],1),a("van-divider",{staticClass:"m0",staticStyle:{"font-size":"12px"},attrs:{"content-position":"left"}},[t._v(t._s(t.taskTips))]),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[1].label"),placeholder:t.$t("postTask.field[1].placeholder")},model:{value:t.postData.title,callback:function(s){t.$set(t.postData,"title","string"===typeof s?s.trim():s)},expression:"postData.title"}}),a("van-field",{attrs:{border:!1,rows:"1",autosize:"",label:t.$t("postTask.field[2].label"),type:"textarea",placeholder:t.$t("postTask.field[2].placeholder")},model:{value:t.postData.content,callback:function(s){t.$set(t.postData,"content","string"===typeof s?s.trim():s)},expression:"postData.content"}}),a("van-field",{attrs:{border:!1,type:"number",label:t.$t("postTask.field[3].label"),placeholder:t.$t("postTask.field[3].placeholder")},on:{input:t.totalPrice},scopedSlots:t._u([{key:"right-icon",fn:function(){return[t._v(t._s(t.$t("postTask.field[3].right")))]},proxy:!0}]),model:{value:t.postData.reward_price,callback:function(s){t.$set(t.postData,"reward_price","string"===typeof s?s.trim():s)},expression:"postData.reward_price"}}),a("van-field",{attrs:{border:!1,type:"digit",label:t.$t("postTask.field[4].label"),placeholder:t.$t("postTask.field[4].placeholder")},on:{input:t.totalPrice},model:{value:t.postData.total_number,callback:function(s){t.$set(t.postData,"total_number","string"===typeof s?s.trim():s)},expression:"postData.total_number"}}),a("van-field",{attrs:{border:!1,type:"digit",label:t.$t("postTask.field[5].label"),placeholder:t.$t("postTask.field[5].placeholder")},scopedSlots:t._u([{key:"right-icon",fn:function(){return[t._v(t._s(t.$t("postTask.field[5].right")))]},proxy:!0}]),model:{value:t.postData.person_time,callback:function(s){t.$set(t.postData,"person_time","string"===typeof s?s.trim():s)},expression:"postData.person_time"}}),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[6].label"),readonly:""},model:{value:t.postData.total_price,callback:function(s){t.$set(t.postData,"total_price",s)},expression:"postData.total_price"}}),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[7].label"),placeholder:t.$t("postTask.field[7].placeholder")},model:{value:t.postData.link_info,callback:function(s){t.$set(t.postData,"link_info","string"===typeof s?s.trim():s)},expression:"postData.link_info"}}),a("van-field",{attrs:{label:t.$t("postTask.field[8].label"),border:!1}},[a("van-dropdown-menu",{attrs:{slot:"input"},slot:"input"},[a("van-dropdown-item",{attrs:{options:t.levelOptions},model:{value:t.postData.task_level,callback:function(s){t.$set(t.postData,"task_level",s)},expression:"postData.task_level"}})],1)],1),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[9].label"),placeholder:t.$t("postTask.field[9].placeholder"),readonly:""},on:{click:function(s){t.showCalendar=!0}},model:{value:t.postData.end_time,callback:function(s){t.$set(t.postData,"end_time",s)},expression:"postData.end_time"}}),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[10].label")},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-checkbox-group",{model:{value:t.conditionArr,callback:function(s){t.conditionArr=s},expression:"conditionArr"}},t._l(t.InitData.authenticationList,(function(s,e){return a("van-checkbox",{key:e,attrs:{name:e}},[t._v(t._s(s))])})),1)]},proxy:!0}])}),a("van-field",{attrs:{label:t.$t("postTask.field[11].label")},scopedSlots:t._u([{key:"input",fn:function(){return[a("van-uploader",{staticClass:"Example",attrs:{"max-count":"4","image-fit":"contain","after-read":t.afterRead},model:{value:t.fileList,callback:function(s){t.fileList=s},expression:"fileList"}})]},proxy:!0}])}),a("van-field",{attrs:{border:!1,label:t.$t("postTask.field[12].label"),placeholder:t.$t("postTask.field[12].placeholder"),readonly:"","is-link":""},on:{click:function(s){t.showSteps=!0}}}),a("i18n",{staticClass:"Tips",attrs:{path:"postTask.tips[0]",tag:"div",places:{pump:t.UserInfo.pump,price:t.postData.total_price}}},[a("br",{attrs:{place:"br"}}),a("router-link",{attrs:{place:"url",to:"/user/recharge"}},[t._v(t._s(t.$t("postTask.tips[1]")))])],1)],1)],1),a("div",{staticStyle:{position:"fixed",bottom:"5px",left:"10px",right:"10px"}},[a("van-button",{staticStyle:{"font-size":"16px"},attrs:{block:"",type:"danger"},on:{click:t.onSubmit}},[t._v(t._s(t.$t("postTask.button")))])],1),a("van-calendar",{attrs:{"show-confirm":!1},on:{confirm:t.onConfirm},model:{value:t.showCalendar,callback:function(s){t.showCalendar=s},expression:"showCalendar"}}),a("van-popup",{staticStyle:{height:"100%",width:"100%",overflow:"hidden"},attrs:{position:"right"},model:{value:t.showSteps,callback:function(s){t.showSteps=s},expression:"showSteps"}},[a("div",{staticClass:"PageBox"},[a("van-nav-bar",{attrs:{fixed:"",border:!1,title:t.$t("postTask.step.title"),"right-text":t.$t("postTask.step.right")},on:{"click-right":function(s){t.showSteps=!1}}}),a("div",{staticClass:"ScrollBox"},[t._l(t.stepData,(function(s,e){return a("van-cell",{key:e,staticClass:"Steps",scopedSlots:t._u([{key:"icon",fn:function(){return[a("i",{staticClass:"tag"},[t._v(t._s(e+1))])]},proxy:!0},{key:"title",fn:function(){return[a("van-uploader",{attrs:{"image-fit":"contain","after-read":t.afterRead,"max-count":1},model:{value:s.img,callback:function(a){t.$set(s,"img",a)},expression:"item.img"}})]},proxy:!0}],null,!0)},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:s.describe,expression:"item.describe"}],attrs:{rows:"2",placeholder:t.$t("postTask.step.placeholder")},domProps:{value:s.describe},on:{input:function(a){a.target.composing||t.$set(s,"describe",a.target.value)}}})])})),a("div",{staticStyle:{"text-align":"center",padding:"10px 0"}},[a("van-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",icon:"cross"},on:{click:t.minusSteps}},[t._v(t._s(t.$t("postTask.step.button[0]")))]),a("van-button",{attrs:{size:"small",icon:"plus",color:"#dd6161"},on:{click:t.pushSteps}},[t._v(t._s(t.$t("postTask.step.button[1]")))])],1)],2)],1)])],1)},i=[],o=a("5104"),l=o["a"],n=(a("32f3"),a("2877")),r=Object(n["a"])(l,e,i,!1,null,"8ae3e916",null);s["default"]=r.exports},7811:function(t,s,a){}}]);